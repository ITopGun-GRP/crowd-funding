---
layout: model
title: Detect Biomedical Entities in English
author: gokhanturer
name: Ner_glove_100d
date: 2022-02-20
tags: [open_source, ner, glove_100d, en]
task: Named Entity Recognition
language: en
edition: Spark NLP 3.1.2
spark_version: 3.0
supported: false
article_header:
  type: cover
use_language_switcher: "Python-Scala-Java"
---

## Description

Named Entity Recognitionmodel annotates text to find features like biomedical (protein) entitites.

## Predicted Entities

`Protein`

{:.btn-box}
<button class="button button-orange" disabled>Live Demo</button>
[Open in Colab](https://colab.research.google.com/drive/1npHXVQbqZ5rFOTReG2DjOGuQFR3cX34Q#scrollTo=Lq8fqJfmFY9V){:.button.button-orange.button-orange-trans.co.button-icon}
[Download](https://s3.amazonaws.com/community.johnsnowlabs.com/gokhanturer/Ner_glove_100d_en_3.1.2_3.0_1645385210378.zip){:.button.button-orange.button-orange-trans.arr.button-icon}

## How to use



<div class="tabs-box" markdown="1">
{% include programmingLanguageSelectScalaPythonNLU.html %}
```python
Open In Colab
JOHNSNOWLABS_LOGO.png
Colab Setup
In [4]:
! pip install -q pyspark==3.1.2 spark-nlp

! pip install -q spark-nlp-display
In [ ]:
import sparknlp

spark = sparknlp.start(gpu = True) 

from sparknlp.base import *
from sparknlp.annotator import *
import pyspark.sql.functions as F
from sparknlp.training import CoNLL

print("Spark NLP version", sparknlp.version())

print("Apache Spark version:", spark.version)

spark
CoNLL Train & Test Data Import
In [6]:
!wget -q https://raw.githubusercontent.com/gokhanturer/NER_Model_SparkNLP/main/BioNLP09_IOB_train.conll
!wget -q https://raw.githubusercontent.com/gokhanturer/NER_Model_SparkNLP/main/BioNLP09_IOB_test.conll
In [ ]:
with open ("BioNLP09_IOB_train.conll") as f:
  train_data = f.read()
Train Data
In [7]:
train_data = CoNLL().readDataset(spark, 'BioNLP09_IOB_train.conll')

train_data.show(5)
22/02/20 18:06:18 WARN TaskSetManager: Stage 0 contains a task of very large size (65003 KiB). The maximum recommended task size is 1000 KiB.
+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
|                text|            document|            sentence|               token|                 pos|               label|
+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
|Reactive oxygen i...|[{document, 0, 13...|[{document, 0, 13...|[{token, 0, 7, Re...|[{pos, 0, 7, NN, ...|[{named_entity, 0...|
|We previously rep...|[{document, 0, 15...|[{document, 0, 15...|[{token, 0, 1, We...|[{pos, 0, 1, NN, ...|[{named_entity, 0...|
|However , the sou...|[{document, 0, 14...|[{document, 0, 14...|[{token, 0, 6, Ho...|[{pos, 0, 6, NN, ...|[{named_entity, 0...|
|5 - LOX and 5 - L...|[{document, 0, 12...|[{document, 0, 12...|[{token, 0, 0, 5,...|[{pos, 0, 0, NN, ...|[{named_entity, 0...|
|Stimulation of ly...|[{document, 0, 29...|[{document, 0, 29...|[{token, 0, 10, S...|[{pos, 0, 10, NN,...|[{named_entity, 0...|
+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
only showing top 5 rows

                                                                                
In [ ]:
train_data.select(F.explode(F.arrays_zip('token.result', 'pos.result',  'label.result')).alias("cols")) \
.select(F.expr("cols['0']").alias("token"),
        F.expr("cols['1']").alias("pos"),
        F.expr("cols['2']").alias("ner_label")).show(truncate=50)
+------------+---+---------+
|       token|pos|ner_label|
+------------+---+---------+
|    Reactive| NN|        O|
|      oxygen| NN|        O|
|intermediate| NN|        O|
|           -| NN|        O|
|   dependent| NN|        O|
|          NF| NN|        O|
|           -| NN|        O|
|      kappaB| NN|        O|
|  activation| NN|        O|
|          by| NN|        O|
| interleukin| NN|B-Protein|
|           -| NN|I-Protein|
|       1beta| NN|I-Protein|
|    requires| NN|        O|
|           5| NN|B-Protein|
|           -| NN|I-Protein|
|lipoxygenase| NN|I-Protein|
|          or| NN|        O|
|       NADPH| NN|        O|
|     oxidase| NN|        O|
+------------+---+---------+
only showing top 20 rows

In [ ]:
train_data.select(F.explode(F.arrays_zip("token.result","label.result")).alias("cols")) \
.select(F.expr("cols['0']").alias("token"),
        F.expr("cols['1']").alias("ground_truth")).groupBy("ground_truth").count().orderBy("count", ascending=False).show(100,truncate=False)
In [8]:
#conll_data.select(F.countDistinct("label.result")).show()
#conll_data.groupBy("label.result").count().show(truncate=False)

train_data = train_data.withColumn('unique', F.array_distinct("label.result"))\
                       .withColumn('c', F.size('unique'))\
                       .filter(F.col('c')>1)

#train_data.select(F.explode(F.arrays_zip('token.result','label.result')).alias("cols")) \
          #.select(F.expr("cols['0']").alias("token"),
                  #F.expr("cols['1']").alias("ground_truth"))\
          #.groupBy('ground_truth')\
          #.count()\
          #.orderBy('count', ascending=False)\
          #.show(100,truncate=False)
Test Data
In [ ]:
with open ("BioNLP09_IOB_test.conll") as f:
  test_data = f.read()
#print (test_data[:500])
In [9]:
test_data = CoNLL().readDataset(spark, 'BioNLP09_IOB_test.conll')
#test_data.show(5)
In [ ]:
test_data.select(F.explode(F.arrays_zip("token.result","label.result")).alias("cols")) \
.select(F.expr("cols['0']").alias("token"),
        F.expr("cols['1']").alias("ground_truth")).groupBy("ground_truth").count().orderBy("count", ascending=False).show(100,truncate=False)
In [10]:
glove_embeddings = WordEmbeddingsModel.pretrained()\
    .setInputCols(["sentence", "token"])\
    .setOutputCol("embeddings")
glove_100d download started this may take some time.
Approximate size to download 145.3 MB
[ | ]glove_100d download started this may take some time.
Approximate size to download 145.3 MB
[ / ]Download done! Loading the resource.
[OK!]
NERDL Model with Glove_100d
In [11]:
glove_embeddings.transform(test_data).write.parquet('/content/drive/MyDrive/Parquet/testdata_bionlp09.parquet')
In [11]:
nerTagger = NerDLApproach()\
    .setInputCols(["sentence", "token", "embeddings"])\
    .setLabelColumn("label")\
    .setOutputCol("ner")\
    .setMaxEpochs(9)\
    .setLr(0.002)\
    .setDropout(0.5)\
    .setBatchSize(15)\
    .setRandomSeed(0)\
    .setVerbose(1)\
    .setEvaluationLogExtended(True) \
    .setEnableOutputLogs(True)\
    .setIncludeConfidence(True)\
    .setTestDataset('/content/drive/MyDrive/Parquet/testdata_bionlp09.parquet')\
    .setEnableMemoryOptimizer(False)

ner_pipeline = Pipeline(stages=[
      glove_embeddings,
      nerTagger
])
In [12]:
%%time

ner_model = ner_pipeline.fit(train_data)
22/02/20 18:07:50 WARN TaskSetManager: Stage 3 contains a task of very large size (65003 KiB). The maximum recommended task size is 1000 KiB.
22/02/20 18:08:10 WARN TaskSetManager: Stage 4 contains a task of very large size (65003 KiB). The maximum recommended task size is 1000 KiB.
2022-02-20 18:08:29.179531: I external/org_tensorflow/tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-02-20 18:08:31.162719: I external/org_tensorflow/tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-02-20 18:08:31.194193: I external/org_tensorflow/tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2022-02-20 18:08:31.250793: E external/org_tensorflow/tensorflow/stream_executor/cuda/cuda_driver.cc:328] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2022-02-20 18:08:31.250950: I external/org_tensorflow/tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (8bc0567551c4): /proc/driver/nvidia/version does not exist
2022-02-20 18:08:31.441607: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ScatterAdd: CPU 
RealDiv: CPU 
VariableV2: CPU 
Identity: CPU 
Add: CPU 
AddV2: CPU 
Unique: CPU 
Shape: CPU 
Sqrt: CPU 
AssignSub: CPU 
Sub: CPU 
Const: CPU 
Fill: CPU 
RandomUniform: CPU 
Mul: CPU 
Assign: CPU 
NoOp: CPU 
GatherV2: CPU 
UnsortedSegmentSum: CPU 
Cast: CPU 
StridedSlice: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_cnn/char_embeddings/Initializer/random_uniform/shape (Const) 
  char_repr_cnn/char_embeddings/Initializer/random_uniform/min (Const) 
  char_repr_cnn/char_embeddings/Initializer/random_uniform/max (Const) 
  char_repr_cnn/char_embeddings/Initializer/random_uniform/RandomUniform (RandomUniform) 
  char_repr_cnn/char_embeddings/Initializer/random_uniform/sub (Sub) 
  char_repr_cnn/char_embeddings/Initializer/random_uniform/mul (Mul) 
  char_repr_cnn/char_embeddings/Initializer/random_uniform (Add) 
  char_repr_cnn/char_embeddings (VariableV2) /device:GPU:0
  char_repr_cnn/char_embeddings/Assign (Assign) /device:GPU:0
  char_repr_cnn/char_embeddings/read (Identity) /device:GPU:0
  char_repr_cnn/embedding_lookup/axis (Const) /device:GPU:0
  char_repr_cnn/embedding_lookup (GatherV2) /device:GPU:0
  training_1/gradients/char_repr_cnn/embedding_lookup_grad/Shape (Const) /device:GPU:0
  training_1/gradients/char_repr_cnn/embedding_lookup_grad/Cast (Cast) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam (VariableV2) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam/Assign (Assign) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam/read (Identity) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam_1 (VariableV2) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam_1/Assign (Assign) /device:GPU:0
  training/char_repr_cnn/char_embeddings/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/Unique (Unique) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/Shape (Shape) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/strided_slice/stack (Const) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/strided_slice/stack_1 (Const) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/strided_slice/stack_2 (Const) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/strided_slice (StridedSlice) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/UnsortedSegmentSum (UnsortedSegmentSum) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/sub/x (Const) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/sub (Sub) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/Sqrt (Sqrt) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/mul (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/sub_1/x (Const) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/sub_1 (Sub) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/truediv (RealDiv) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/sub_2/x (Const) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/sub_2 (Sub) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/mul_1 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/mul_2 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/Assign (Assign) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/ScatterAdd (ScatterAdd) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/mul_3 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/sub_3/x (Const) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/sub_3 (Sub) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/mul_4 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/mul_5 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/Assign_1 (Assign) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/ScatterAdd_1 (ScatterAdd) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/Sqrt_1 (Sqrt) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/mul_6 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/add (AddV2) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/truediv_1 (RealDiv) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/AssignSub (AssignSub) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/char_embeddings/group_deps (NoOp) /device:GPU:0
  save/Assign_2 (Assign) /device:GPU:0
  save/Assign_41 (Assign) /device:GPU:0
  save/Assign_42 (Assign) /device:GPU:0

2022-02-20 18:08:31.450256: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ResourceApplyAdam: CPU 
AssignVariableOp: CPU 
RandomUniform: CPU 
Fill: CPU 
VarIsInitializedOp: CPU 
Const: CPU 
Mul: CPU 
ReadVariableOp: CPU 
Sub: CPU 
VarHandleOp: CPU 
Add: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_cnn/conv1d/kernel/Initializer/random_uniform/shape (Const) 
  char_repr_cnn/conv1d/kernel/Initializer/random_uniform/min (Const) 
  char_repr_cnn/conv1d/kernel/Initializer/random_uniform/max (Const) 
  char_repr_cnn/conv1d/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  char_repr_cnn/conv1d/kernel/Initializer/random_uniform/sub (Sub) 
  char_repr_cnn/conv1d/kernel/Initializer/random_uniform/mul (Mul) 
  char_repr_cnn/conv1d/kernel/Initializer/random_uniform (Add) 
  char_repr_cnn/conv1d/kernel (VarHandleOp) /device:GPU:0
  char_repr_cnn/conv1d/kernel/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  char_repr_cnn/conv1d/kernel/Assign (AssignVariableOp) /device:GPU:0
  char_repr_cnn/conv1d/kernel/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_cnn/conv1d/conv1d/ExpandDims_1/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam (VarHandleOp) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam_1 (VarHandleOp) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam_1/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam_1/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_cnn/conv1d/kernel/Adam_1/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/conv1d/kernel/ResourceApplyAdam (ResourceApplyAdam) /device:GPU:0
  save/AssignVariableOp_1 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_10 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_11 (AssignVariableOp) /device:GPU:0

2022-02-20 18:08:31.450870: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ResourceApplyAdam: CPU 
ReadVariableOp: CPU 
AssignVariableOp: CPU 
VarIsInitializedOp: CPU 
Const: CPU 
VarHandleOp: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_cnn/conv1d/bias/Initializer/zeros (Const) 
  char_repr_cnn/conv1d/bias (VarHandleOp) /device:GPU:0
  char_repr_cnn/conv1d/bias/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  char_repr_cnn/conv1d/bias/Assign (AssignVariableOp) /device:GPU:0
  char_repr_cnn/conv1d/bias/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_cnn/conv1d/BiasAdd/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam (VarHandleOp) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam_1 (VarHandleOp) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam_1/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam_1/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_cnn/conv1d/bias/Adam_1/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training_1/Adam/update_char_repr_cnn/conv1d/bias/ResourceApplyAdam (ResourceApplyAdam) /device:GPU:0
  save/AssignVariableOp (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_8 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_9 (AssignVariableOp) /device:GPU:0

2022-02-20 18:08:31.451739: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ScatterAdd: CPU 
RealDiv: CPU 
VariableV2: CPU 
Identity: CPU 
Add: CPU 
AddV2: CPU 
Unique: CPU 
Shape: CPU 
Sqrt: CPU 
AssignSub: CPU 
Sub: CPU 
Const: CPU 
Fill: CPU 
RandomUniform: CPU 
Mul: CPU 
Assign: CPU 
NoOp: CPU 
GatherV2: CPU 
UnsortedSegmentSum: CPU 
Cast: CPU 
StridedSlice: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_lstm/char_embeddings/Initializer/random_uniform/shape (Const) 
  char_repr_lstm/char_embeddings/Initializer/random_uniform/min (Const) 
  char_repr_lstm/char_embeddings/Initializer/random_uniform/max (Const) 
  char_repr_lstm/char_embeddings/Initializer/random_uniform/RandomUniform (RandomUniform) 
  char_repr_lstm/char_embeddings/Initializer/random_uniform/sub (Sub) 
  char_repr_lstm/char_embeddings/Initializer/random_uniform/mul (Mul) 
  char_repr_lstm/char_embeddings/Initializer/random_uniform (Add) 
  char_repr_lstm/char_embeddings (VariableV2) /device:GPU:0
  char_repr_lstm/char_embeddings/Assign (Assign) /device:GPU:0
  char_repr_lstm/char_embeddings/read (Identity) /device:GPU:0
  char_repr_lstm/embedding_lookup/axis (Const) /device:GPU:0
  char_repr_lstm/embedding_lookup (GatherV2) /device:GPU:0
  training_1/gradients/char_repr_lstm/embedding_lookup_grad/Shape (Const) /device:GPU:0
  training_1/gradients/char_repr_lstm/embedding_lookup_grad/Cast (Cast) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam (VariableV2) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam/Assign (Assign) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam/read (Identity) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam_1 (VariableV2) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam_1/Assign (Assign) /device:GPU:0
  training/char_repr_lstm/char_embeddings/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/Unique (Unique) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/Shape (Shape) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/strided_slice/stack (Const) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/strided_slice/stack_1 (Const) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/strided_slice/stack_2 (Const) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/strided_slice (StridedSlice) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/UnsortedSegmentSum (UnsortedSegmentSum) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/sub/x (Const) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/sub (Sub) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/Sqrt (Sqrt) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/mul (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/sub_1/x (Const) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/sub_1 (Sub) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/truediv (RealDiv) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/sub_2/x (Const) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/sub_2 (Sub) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/mul_1 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/mul_2 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/Assign (Assign) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/ScatterAdd (ScatterAdd) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/mul_3 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/sub_3/x (Const) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/sub_3 (Sub) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/mul_4 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/mul_5 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/Assign_1 (Assign) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/ScatterAdd_1 (ScatterAdd) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/Sqrt_1 (Sqrt) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/mul_6 (Mul) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/add (AddV2) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/truediv_1 (RealDiv) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/AssignSub (AssignSub) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/char_embeddings/group_deps (NoOp) /device:GPU:0
  save/Assign_3 (Assign) /device:GPU:0
  save/Assign_43 (Assign) /device:GPU:0
  save/Assign_44 (Assign) /device:GPU:0

2022-02-20 18:08:31.452237: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ResourceApplyAdam: CPU 
Enter: CPU 
AssignVariableOp: CPU 
RandomUniform: CPU 
Fill: CPU 
VarIsInitializedOp: CPU 
Const: CPU 
Mul: CPU 
ReadVariableOp: CPU 
Sub: CPU 
VarHandleOp: CPU 
Add: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Initializer/random_uniform/shape (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Initializer/random_uniform/min (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Initializer/random_uniform/max (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Initializer/random_uniform/sub (Sub) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Initializer/random_uniform/mul (Mul) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Initializer/random_uniform (Add) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel (VarHandleOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Assign (AssignVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/split/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/split/ReadVariableOp/Enter (Enter) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/split/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam_1 (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam_1/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam_1/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/Adam_1/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/sequential/bidirectional/forward_lstm/kernel/ResourceApplyAdam (ResourceApplyAdam) /device:GPU:0
  save/AssignVariableOp_6 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_20 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_21 (AssignVariableOp) /device:GPU:0

2022-02-20 18:08:31.452686: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ResourceApplyAdam: CPU 
Enter: CPU 
AssignVariableOp: CPU 
Transpose: CPU 
Reshape: CPU 
Sign: CPU 
RandomStandardNormal: CPU 
VarHandleOp: CPU 
Add: CPU 
Fill: CPU 
VarIsInitializedOp: CPU 
Const: CPU 
Mul: CPU 
ReadVariableOp: CPU 
Qr: CPU 
DiagPart: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/random_normal/shape (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/random_normal/mean (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/random_normal/stddev (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/random_normal/RandomStandardNormal (RandomStandardNormal) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/random_normal/mul (Mul) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/random_normal (Add) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/Qr (Qr) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/DiagPart (DiagPart) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/Sign (Sign) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/mul (Mul) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/matrix_transpose/transpose/perm (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/matrix_transpose/transpose (Transpose) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/Reshape/shape (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/Reshape (Reshape) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/mul_1/x (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Initializer/mul_1 (Mul) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel (VarHandleOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Assign (AssignVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/ReadVariableOp_1 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/ReadVariableOp_2 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/ReadVariableOp_3 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/ReadVariableOp/Enter (Enter) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/ReadVariableOp_1 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/ReadVariableOp_2 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/ReadVariableOp_3 (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam_1 (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam_1/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam_1/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/Adam_1/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/sequential/bidirectional/forward_lstm/recurrent_kernel/ResourceApplyAdam (ResourceApplyAdam) /device:GPU:0
  save/AssignVariableOp_7 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_22 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_23 (AssignVariableOp) /device:GPU:0

2022-02-20 18:08:31.453033: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ResourceApplyAdam: CPU 
Enter: CPU 
ConcatV2: CPU 
VarHandleOp: CPU 
Const: CPU 
VarIsInitializedOp: CPU 
AssignVariableOp: CPU 
ReadVariableOp: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Initializer/zeros (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Initializer/ones (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Initializer/zeros_1 (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Initializer/concat/axis (Const) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Initializer/concat (ConcatV2) 
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias (VarHandleOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Assign (AssignVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/split_1/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/split_1/ReadVariableOp/Enter (Enter) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/forward_lstm_1/while/split_1/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam_1 (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam_1/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam_1/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/forward_lstm/bias/Adam_1/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/sequential/bidirectional/forward_lstm/bias/ResourceApplyAdam (ResourceApplyAdam) /device:GPU:0
  save/AssignVariableOp_5 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_18 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_19 (AssignVariableOp) /device:GPU:0

2022-02-20 18:08:31.453367: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ResourceApplyAdam: CPU 
Enter: CPU 
AssignVariableOp: CPU 
RandomUniform: CPU 
Fill: CPU 
VarIsInitializedOp: CPU 
Const: CPU 
Mul: CPU 
ReadVariableOp: CPU 
Sub: CPU 
VarHandleOp: CPU 
Add: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Initializer/random_uniform/shape (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Initializer/random_uniform/min (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Initializer/random_uniform/max (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Initializer/random_uniform/sub (Sub) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Initializer/random_uniform/mul (Mul) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Initializer/random_uniform (Add) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel (VarHandleOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Assign (AssignVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/split/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/split/ReadVariableOp/Enter (Enter) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/split/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam_1 (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam_1/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam_1/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/Adam_1/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/sequential/bidirectional/backward_lstm/kernel/ResourceApplyAdam (ResourceApplyAdam) /device:GPU:0
  save/AssignVariableOp_3 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_14 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_15 (AssignVariableOp) /device:GPU:0

2022-02-20 18:08:31.453769: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ResourceApplyAdam: CPU 
Enter: CPU 
AssignVariableOp: CPU 
Transpose: CPU 
Reshape: CPU 
Sign: CPU 
RandomStandardNormal: CPU 
VarHandleOp: CPU 
Add: CPU 
Fill: CPU 
VarIsInitializedOp: CPU 
Const: CPU 
Mul: CPU 
ReadVariableOp: CPU 
Qr: CPU 
DiagPart: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/random_normal/shape (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/random_normal/mean (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/random_normal/stddev (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/random_normal/RandomStandardNormal (RandomStandardNormal) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/random_normal/mul (Mul) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/random_normal (Add) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/Qr (Qr) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/DiagPart (DiagPart) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/Sign (Sign) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/mul (Mul) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/matrix_transpose/transpose/perm (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/matrix_transpose/transpose (Transpose) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/Reshape/shape (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/Reshape (Reshape) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/mul_1/x (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Initializer/mul_1 (Mul) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel (VarHandleOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Assign (AssignVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/ReadVariableOp_1 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/ReadVariableOp_2 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/ReadVariableOp_3 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/ReadVariableOp/Enter (Enter) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/ReadVariableOp_1 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/ReadVariableOp_2 (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/ReadVariableOp_3 (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam_1 (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam_1/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam_1/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/Adam_1/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/sequential/bidirectional/backward_lstm/recurrent_kernel/ResourceApplyAdam (ResourceApplyAdam) /device:GPU:0
  save/AssignVariableOp_4 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_16 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_17 (AssignVariableOp) /device:GPU:0

2022-02-20 18:08:31.462286: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
ResourceApplyAdam: CPU 
Enter: CPU 
ConcatV2: CPU 
VarHandleOp: CPU 
Const: CPU 
VarIsInitializedOp: CPU 
AssignVariableOp: CPU 
ReadVariableOp: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Initializer/zeros (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Initializer/ones (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Initializer/zeros_1 (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Initializer/concat/axis (Const) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Initializer/concat (ConcatV2) 
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias (VarHandleOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Assign (AssignVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/split_1/ReadVariableOp (ReadVariableOp) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/split_1/ReadVariableOp/Enter (Enter) /device:GPU:0
  char_repr_lstm/sequential/bidirectional/backward_lstm_1/while/split_1/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam_1 (VarHandleOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam_1/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam_1/Assign (AssignVariableOp) /device:GPU:0
  training/char_repr_lstm/sequential/bidirectional/backward_lstm/bias/Adam_1/Read/ReadVariableOp (ReadVariableOp) /device:GPU:0
  training_1/Adam/update_char_repr_lstm/sequential/bidirectional/backward_lstm/bias/ResourceApplyAdam (ResourceApplyAdam) /device:GPU:0
  save/AssignVariableOp_2 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_12 (AssignVariableOp) /device:GPU:0
  save/AssignVariableOp_13 (AssignVariableOp) /device:GPU:0

2022-02-20 18:08:31.463605: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Fill: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  W/Initializer/random_uniform/shape (Const) 
  W/Initializer/random_uniform/min (Const) 
  W/Initializer/random_uniform/max (Const) 
  W/Initializer/random_uniform/RandomUniform (RandomUniform) 
  W/Initializer/random_uniform/sub (Sub) 
  W/Initializer/random_uniform/mul (Mul) 
  W/Initializer/random_uniform (Add) 
  W (VariableV2) /device:GPU:0
  W/Assign (Assign) /device:GPU:0
  W/read (Identity) /device:GPU:0
  training_1/beta1_power/initial_value (Const) /device:GPU:0
  training_1/beta1_power (VariableV2) /device:GPU:0
  training_1/beta1_power/Assign (Assign) /device:GPU:0
  training_1/beta1_power/read (Identity) /device:GPU:0
  training_1/beta2_power/initial_value (Const) /device:GPU:0
  training_1/beta2_power (VariableV2) /device:GPU:0
  training_1/beta2_power/Assign (Assign) /device:GPU:0
  training_1/beta2_power/read (Identity) /device:GPU:0
  training/W/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/W/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/W/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/W/Adam (VariableV2) /device:GPU:0
  training/W/Adam/Assign (Assign) /device:GPU:0
  training/W/Adam/read (Identity) /device:GPU:0
  training/W/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/W/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/W/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/W/Adam_1 (VariableV2) /device:GPU:0
  training/W/Adam_1/Assign (Assign) /device:GPU:0
  training/W/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_W/ApplyAdam (ApplyAdam) /device:GPU:0
  training_1/Adam/mul (Mul) /device:GPU:0
  training_1/Adam/Assign (Assign) /device:GPU:0
  training_1/Adam/mul_1 (Mul) /device:GPU:0
  training_1/Adam/Assign_1 (Assign) /device:GPU:0
  save/Assign (Assign) /device:GPU:0
  save/Assign_37 (Assign) /device:GPU:0
  save/Assign_38 (Assign) /device:GPU:0
  save/Assign_111 (Assign) /device:GPU:0
  save/Assign_112 (Assign) /device:GPU:0

2022-02-20 18:08:31.464069: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  b/Initializer/random_uniform/shape (Const) 
  b/Initializer/random_uniform/min (Const) 
  b/Initializer/random_uniform/max (Const) 
  b/Initializer/random_uniform/RandomUniform (RandomUniform) 
  b/Initializer/random_uniform/sub (Sub) 
  b/Initializer/random_uniform/mul (Mul) 
  b/Initializer/random_uniform (Add) 
  b (VariableV2) /device:GPU:0
  b/Assign (Assign) /device:GPU:0
  b/read (Identity) /device:GPU:0
  training/b/Adam/Initializer/zeros (Const) /device:GPU:0
  training/b/Adam (VariableV2) /device:GPU:0
  training/b/Adam/Assign (Assign) /device:GPU:0
  training/b/Adam/read (Identity) /device:GPU:0
  training/b/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/b/Adam_1 (VariableV2) /device:GPU:0
  training/b/Adam_1/Assign (Assign) /device:GPU:0
  training/b/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_b/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_1 (Assign) /device:GPU:0
  save/Assign_39 (Assign) /device:GPU:0
  save/Assign_40 (Assign) /device:GPU:0

2022-02-20 18:08:31.464440: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Fill: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell/kernel/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-0/lstm_fused_cell/kernel/Initializer/random_uniform/min (Const) 
  context_repr/lstm-0/lstm_fused_cell/kernel/Initializer/random_uniform/max (Const) 
  context_repr/lstm-0/lstm_fused_cell/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-0/lstm_fused_cell/kernel/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-0/lstm_fused_cell/kernel/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-0/lstm_fused_cell/kernel/Initializer/random_uniform (Add) 
  context_repr/lstm-0/lstm_fused_cell/kernel (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/kernel/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/kernel/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/kernel/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell/kernel/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_7 (Assign) /device:GPU:0
  save/Assign_51 (Assign) /device:GPU:0
  save/Assign_52 (Assign) /device:GPU:0

2022-02-20 18:08:31.464722: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Identity: CPU 
Assign: CPU 
Const: CPU 
ApplyAdam: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell/bias/Initializer/Const (Const) 
  context_repr/lstm-0/lstm_fused_cell/bias (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/bias/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/bias/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/bias/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/bias/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/bias/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/bias/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/bias/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/bias/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell/bias/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_6 (Assign) /device:GPU:0
  save/Assign_49 (Assign) /device:GPU:0
  save/Assign_50 (Assign) /device:GPU:0

2022-02-20 18:08:31.465066: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-0/lstm_fused_cell/w_i_diag (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/w_i_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_i_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_i_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_i_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_i_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_i_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_i_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_i_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_i_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell/w_i_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_9 (Assign) /device:GPU:0
  save/Assign_55 (Assign) /device:GPU:0
  save/Assign_56 (Assign) /device:GPU:0

2022-02-20 18:08:31.465349: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-0/lstm_fused_cell/w_f_diag (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/w_f_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_f_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_f_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_f_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_f_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_f_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_f_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_f_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_f_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell/w_f_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_8 (Assign) /device:GPU:0
  save/Assign_53 (Assign) /device:GPU:0
  save/Assign_54 (Assign) /device:GPU:0

2022-02-20 18:08:31.465631: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-0/lstm_fused_cell/w_o_diag (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell/w_o_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_o_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_o_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_o_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_o_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_o_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_o_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_o_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell/w_o_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell/w_o_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_10 (Assign) /device:GPU:0
  save/Assign_57 (Assign) /device:GPU:0
  save/Assign_58 (Assign) /device:GPU:0

2022-02-20 18:08:31.474150: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Fill: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell_1/kernel/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/kernel/Initializer/random_uniform/min (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/kernel/Initializer/random_uniform/max (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-0/lstm_fused_cell_1/kernel/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-0/lstm_fused_cell_1/kernel/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-0/lstm_fused_cell_1/kernel/Initializer/random_uniform (Add) 
  context_repr/lstm-0/lstm_fused_cell_1/kernel (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/kernel/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/kernel/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/kernel/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell_1/kernel/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_12 (Assign) /device:GPU:0
  save/Assign_61 (Assign) /device:GPU:0
  save/Assign_62 (Assign) /device:GPU:0

2022-02-20 18:08:31.474768: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Identity: CPU 
Assign: CPU 
Const: CPU 
ApplyAdam: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell_1/bias/Initializer/Const (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/bias (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/bias/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/bias/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/bias/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/bias/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/bias/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/bias/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/bias/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/bias/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell_1/bias/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_11 (Assign) /device:GPU:0
  save/Assign_59 (Assign) /device:GPU:0
  save/Assign_60 (Assign) /device:GPU:0

2022-02-20 18:08:31.475268: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell_1/w_i_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_14 (Assign) /device:GPU:0
  save/Assign_65 (Assign) /device:GPU:0
  save/Assign_66 (Assign) /device:GPU:0

2022-02-20 18:08:31.475591: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell_1/w_f_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_13 (Assign) /device:GPU:0
  save/Assign_63 (Assign) /device:GPU:0
  save/Assign_64 (Assign) /device:GPU:0

2022-02-20 18:08:31.475898: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag (VariableV2) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-0/lstm_fused_cell_1/w_o_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_15 (Assign) /device:GPU:0
  save/Assign_67 (Assign) /device:GPU:0
  save/Assign_68 (Assign) /device:GPU:0

2022-02-20 18:08:31.476334: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Fill: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell/kernel/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-1/lstm_fused_cell/kernel/Initializer/random_uniform/min (Const) 
  context_repr/lstm-1/lstm_fused_cell/kernel/Initializer/random_uniform/max (Const) 
  context_repr/lstm-1/lstm_fused_cell/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-1/lstm_fused_cell/kernel/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-1/lstm_fused_cell/kernel/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-1/lstm_fused_cell/kernel/Initializer/random_uniform (Add) 
  context_repr/lstm-1/lstm_fused_cell/kernel (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/kernel/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/kernel/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/kernel/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell/kernel/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_17 (Assign) /device:GPU:0
  save/Assign_71 (Assign) /device:GPU:0
  save/Assign_72 (Assign) /device:GPU:0

2022-02-20 18:08:31.476606: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Identity: CPU 
Assign: CPU 
Const: CPU 
ApplyAdam: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell/bias/Initializer/Const (Const) 
  context_repr/lstm-1/lstm_fused_cell/bias (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/bias/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/bias/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/bias/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/bias/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/bias/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/bias/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/bias/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/bias/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell/bias/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_16 (Assign) /device:GPU:0
  save/Assign_69 (Assign) /device:GPU:0
  save/Assign_70 (Assign) /device:GPU:0

2022-02-20 18:08:31.476908: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-1/lstm_fused_cell/w_i_diag (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/w_i_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_i_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_i_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_i_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_i_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_i_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_i_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_i_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_i_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell/w_i_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_19 (Assign) /device:GPU:0
  save/Assign_75 (Assign) /device:GPU:0
  save/Assign_76 (Assign) /device:GPU:0

2022-02-20 18:08:31.477230: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-1/lstm_fused_cell/w_f_diag (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/w_f_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_f_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_f_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_f_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_f_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_f_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_f_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_f_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_f_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell/w_f_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_18 (Assign) /device:GPU:0
  save/Assign_73 (Assign) /device:GPU:0
  save/Assign_74 (Assign) /device:GPU:0

2022-02-20 18:08:31.477519: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-1/lstm_fused_cell/w_o_diag (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell/w_o_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_o_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_o_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_o_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_o_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_o_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_o_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_o_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell/w_o_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell/w_o_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_20 (Assign) /device:GPU:0
  save/Assign_77 (Assign) /device:GPU:0
  save/Assign_78 (Assign) /device:GPU:0

2022-02-20 18:08:31.477915: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Fill: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell_1/kernel/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/kernel/Initializer/random_uniform/min (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/kernel/Initializer/random_uniform/max (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-1/lstm_fused_cell_1/kernel/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-1/lstm_fused_cell_1/kernel/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-1/lstm_fused_cell_1/kernel/Initializer/random_uniform (Add) 
  context_repr/lstm-1/lstm_fused_cell_1/kernel (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/kernel/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/kernel/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/kernel/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell_1/kernel/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_22 (Assign) /device:GPU:0
  save/Assign_81 (Assign) /device:GPU:0
  save/Assign_82 (Assign) /device:GPU:0

2022-02-20 18:08:31.484703: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Identity: CPU 
Assign: CPU 
Const: CPU 
ApplyAdam: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell_1/bias/Initializer/Const (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/bias (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/bias/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/bias/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/bias/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/bias/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/bias/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/bias/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/bias/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/bias/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell_1/bias/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_21 (Assign) /device:GPU:0
  save/Assign_79 (Assign) /device:GPU:0
  save/Assign_80 (Assign) /device:GPU:0

2022-02-20 18:08:31.485335: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell_1/w_i_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_24 (Assign) /device:GPU:0
  save/Assign_85 (Assign) /device:GPU:0
  save/Assign_86 (Assign) /device:GPU:0

2022-02-20 18:08:31.485728: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell_1/w_f_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_23 (Assign) /device:GPU:0
  save/Assign_83 (Assign) /device:GPU:0
  save/Assign_84 (Assign) /device:GPU:0

2022-02-20 18:08:31.495166: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag (VariableV2) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-1/lstm_fused_cell_1/w_o_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_25 (Assign) /device:GPU:0
  save/Assign_87 (Assign) /device:GPU:0
  save/Assign_88 (Assign) /device:GPU:0

2022-02-20 18:08:31.495916: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Fill: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell/kernel/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-2/lstm_fused_cell/kernel/Initializer/random_uniform/min (Const) 
  context_repr/lstm-2/lstm_fused_cell/kernel/Initializer/random_uniform/max (Const) 
  context_repr/lstm-2/lstm_fused_cell/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-2/lstm_fused_cell/kernel/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-2/lstm_fused_cell/kernel/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-2/lstm_fused_cell/kernel/Initializer/random_uniform (Add) 
  context_repr/lstm-2/lstm_fused_cell/kernel (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/kernel/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/kernel/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/kernel/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell/kernel/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_27 (Assign) /device:GPU:0
  save/Assign_91 (Assign) /device:GPU:0
  save/Assign_92 (Assign) /device:GPU:0

2022-02-20 18:08:31.496396: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Identity: CPU 
Assign: CPU 
Const: CPU 
ApplyAdam: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell/bias/Initializer/Const (Const) 
  context_repr/lstm-2/lstm_fused_cell/bias (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/bias/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/bias/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/bias/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/bias/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/bias/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/bias/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/bias/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/bias/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell/bias/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_26 (Assign) /device:GPU:0
  save/Assign_89 (Assign) /device:GPU:0
  save/Assign_90 (Assign) /device:GPU:0

2022-02-20 18:08:31.496780: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-2/lstm_fused_cell/w_i_diag (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/w_i_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_i_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_i_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_i_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_i_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_i_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_i_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_i_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_i_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell/w_i_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_29 (Assign) /device:GPU:0
  save/Assign_95 (Assign) /device:GPU:0
  save/Assign_96 (Assign) /device:GPU:0

2022-02-20 18:08:31.497124: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-2/lstm_fused_cell/w_f_diag (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/w_f_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_f_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_f_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_f_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_f_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_f_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_f_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_f_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_f_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell/w_f_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_28 (Assign) /device:GPU:0
  save/Assign_93 (Assign) /device:GPU:0
  save/Assign_94 (Assign) /device:GPU:0

2022-02-20 18:08:31.497408: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-2/lstm_fused_cell/w_o_diag (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell/w_o_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_o_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_o_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_o_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_o_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_o_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_o_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_o_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell/w_o_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell/w_o_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_30 (Assign) /device:GPU:0
  save/Assign_97 (Assign) /device:GPU:0
  save/Assign_98 (Assign) /device:GPU:0

2022-02-20 18:08:31.497798: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Fill: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell_1/kernel/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/kernel/Initializer/random_uniform/min (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/kernel/Initializer/random_uniform/max (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/kernel/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-2/lstm_fused_cell_1/kernel/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-2/lstm_fused_cell_1/kernel/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-2/lstm_fused_cell_1/kernel/Initializer/random_uniform (Add) 
  context_repr/lstm-2/lstm_fused_cell_1/kernel (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/kernel/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/kernel/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/kernel/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell_1/kernel/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_32 (Assign) /device:GPU:0
  save/Assign_101 (Assign) /device:GPU:0
  save/Assign_102 (Assign) /device:GPU:0

2022-02-20 18:08:31.498092: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Identity: CPU 
Assign: CPU 
Const: CPU 
ApplyAdam: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell_1/bias/Initializer/Const (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/bias (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/bias/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/bias/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/bias/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/bias/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/bias/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/bias/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/bias/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/bias/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/bias/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/bias/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell_1/bias/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_31 (Assign) /device:GPU:0
  save/Assign_99 (Assign) /device:GPU:0
  save/Assign_100 (Assign) /device:GPU:0

2022-02-20 18:08:31.498377: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell_1/w_i_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_34 (Assign) /device:GPU:0
  save/Assign_105 (Assign) /device:GPU:0
  save/Assign_106 (Assign) /device:GPU:0

2022-02-20 18:08:31.498666: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell_1/w_f_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_33 (Assign) /device:GPU:0
  save/Assign_103 (Assign) /device:GPU:0
  save/Assign_104 (Assign) /device:GPU:0

2022-02-20 18:08:31.506054: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/shape (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/min (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/max (Const) 
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/sub (Sub) 
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform/mul (Mul) 
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Initializer/random_uniform (Add) 
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag (VariableV2) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Assign (Assign) /device:GPU:0
  context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Adam (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Adam/read (Identity) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/lstm-2/lstm_fused_cell_1/w_o_diag/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_35 (Assign) /device:GPU:0
  save/Assign_107 (Assign) /device:GPU:0
  save/Assign_108 (Assign) /device:GPU:0

2022-02-20 18:08:31.506869: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Fill: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/W/Initializer/random_uniform/shape (Const) 
  context_repr/W/Initializer/random_uniform/min (Const) 
  context_repr/W/Initializer/random_uniform/max (Const) 
  context_repr/W/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/W/Initializer/random_uniform/sub (Sub) 
  context_repr/W/Initializer/random_uniform/mul (Mul) 
  context_repr/W/Initializer/random_uniform (Add) 
  context_repr/W (VariableV2) /device:GPU:0
  context_repr/W/Assign (Assign) /device:GPU:0
  context_repr/W/read (Identity) /device:GPU:0
  training/context_repr/W/Adam/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/W/Adam/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/W/Adam/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/W/Adam (VariableV2) /device:GPU:0
  training/context_repr/W/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/W/Adam/read (Identity) /device:GPU:0
  training/context_repr/W/Adam_1/Initializer/zeros/shape_as_tensor (Const) /device:GPU:0
  training/context_repr/W/Adam_1/Initializer/zeros/Const (Const) /device:GPU:0
  training/context_repr/W/Adam_1/Initializer/zeros (Fill) /device:GPU:0
  training/context_repr/W/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/W/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/W/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/W/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_4 (Assign) /device:GPU:0
  save/Assign_45 (Assign) /device:GPU:0
  save/Assign_46 (Assign) /device:GPU:0

2022-02-20 18:08:31.507391: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  context_repr/b/Initializer/random_uniform/shape (Const) 
  context_repr/b/Initializer/random_uniform/min (Const) 
  context_repr/b/Initializer/random_uniform/max (Const) 
  context_repr/b/Initializer/random_uniform/RandomUniform (RandomUniform) 
  context_repr/b/Initializer/random_uniform/sub (Sub) 
  context_repr/b/Initializer/random_uniform/mul (Mul) 
  context_repr/b/Initializer/random_uniform (Add) 
  context_repr/b (VariableV2) /device:GPU:0
  context_repr/b/Assign (Assign) /device:GPU:0
  context_repr/b/read (Identity) /device:GPU:0
  training/context_repr/b/Adam/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/b/Adam (VariableV2) /device:GPU:0
  training/context_repr/b/Adam/Assign (Assign) /device:GPU:0
  training/context_repr/b/Adam/read (Identity) /device:GPU:0
  training/context_repr/b/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/context_repr/b/Adam_1 (VariableV2) /device:GPU:0
  training/context_repr/b/Adam_1/Assign (Assign) /device:GPU:0
  training/context_repr/b/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_context_repr/b/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_5 (Assign) /device:GPU:0
  save/Assign_47 (Assign) /device:GPU:0
  save/Assign_48 (Assign) /device:GPU:0

2022-02-20 18:08:31.507762: W external/org_tensorflow/tensorflow/core/common_runtime/colocation_graph.cc:1139] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources' devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_='/device:GPU:0' assigned_device_name_='' resource_device_name_='/device:GPU:0' supported_device_types_=[CPU] possible_devices_=[]
Switch: CPU 
Assign: CPU 
ApplyAdam: CPU 
RandomUniform: CPU 
Const: CPU 
Mul: CPU 
Sub: CPU 
Add: CPU 
Identity: CPU 
VariableV2: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  inference/transition_params/Initializer/random_uniform/shape (Const) 
  inference/transition_params/Initializer/random_uniform/min (Const) 
  inference/transition_params/Initializer/random_uniform/max (Const) 
  inference/transition_params/Initializer/random_uniform/RandomUniform (RandomUniform) 
  inference/transition_params/Initializer/random_uniform/sub (Sub) 
  inference/transition_params/Initializer/random_uniform/mul (Mul) 
  inference/transition_params/Initializer/random_uniform (Add) 
  inference/transition_params (VariableV2) /device:GPU:0
  inference/transition_params/Assign (Assign) /device:GPU:0
  inference/transition_params/read (Identity) /device:GPU:0
  inference/cond/Reshape_4/Switch (Switch) /device:GPU:0
  inference/cond_1/ExpandDims/Switch (Switch) /device:GPU:0
  inference/cond_2/ExpandDims_1/Switch (Switch) /device:GPU:0
  training/inference/transition_params/Adam/Initializer/zeros (Const) /device:GPU:0
  training/inference/transition_params/Adam (VariableV2) /device:GPU:0
  training/inference/transition_params/Adam/Assign (Assign) /device:GPU:0
  training/inference/transition_params/Adam/read (Identity) /device:GPU:0
  training/inference/transition_params/Adam_1/Initializer/zeros (Const) /device:GPU:0
  training/inference/transition_params/Adam_1 (VariableV2) /device:GPU:0
  training/inference/transition_params/Adam_1/Assign (Assign) /device:GPU:0
  training/inference/transition_params/Adam_1/read (Identity) /device:GPU:0
  training_1/Adam/update_inference/transition_params/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_36 (Assign) /device:GPU:0
  save/Assign_109 (Assign) /device:GPU:0
  save/Assign_110 (Assign) /device:GPU:0

2022-02-20 18:08:31.579290: I external/org_tensorflow/tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2200160000 Hz
Training started - total epochs: 9 - lr: 0.002 - batch size: 15 - labels: 3 - chars: 80 - training examples: 4711
Epoch 1/9 started, lr: 0.002, dataset size: 4711
Epoch 1/9 - 147.58s - loss: 2038.943 - batches: 316
Quality on test dataset: 
time to finish evaluation: 18.39s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3167	 683	 911	 0.8225974	 0.7766062	 0.7989405
B-Protein	 2747	 659	 842	 0.8065179	 0.7653943	 0.7854182
tp: 5914 fp: 1342 fn: 1753 labels: 2
Macro-average	 prec: 0.8145577, rec: 0.77100027, f1: 0.79218066
Micro-average	 prec: 0.8150496, rec: 0.7713578, f1: 0.792602
Epoch 2/9 started, lr: 0.0019900498, dataset size: 4711
Epoch 2/9 - 142.76s - loss: 910.4699 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.53s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3360	 834	 718	 0.8011445	 0.8239333	 0.8123791
B-Protein	 3036	 743	 553	 0.80338717	 0.84591806	 0.82410425
tp: 6396 fp: 1577 fn: 1271 labels: 2
Macro-average	 prec: 0.8022658, rec: 0.83492565, f1: 0.8182699
Micro-average	 prec: 0.80220747, rec: 0.8342246, f1: 0.8179028
Epoch 3/9 started, lr: 0.001980198, dataset size: 4711
Epoch 3/9 - 143.98s - loss: 646.76074 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.25s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3111	 342	 967	 0.9009557	 0.76287395	 0.82618517
B-Protein	 2928	 423	 661	 0.87376904	 0.8158261	 0.843804
tp: 6039 fp: 765 fn: 1628 labels: 2
Macro-average	 prec: 0.88736236, rec: 0.78935003, f1: 0.83549154
Micro-average	 prec: 0.88756615, rec: 0.78766143, f1: 0.8346348
Epoch 4/9 started, lr: 0.0019704434, dataset size: 4711
Epoch 4/9 - 142.39s - loss: 518.10095 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.40s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3464	 822	 614	 0.80821276	 0.849436	 0.82831174
B-Protein	 3073	 560	 516	 0.84585744	 0.85622734	 0.8510108
tp: 6537 fp: 1382 fn: 1130 labels: 2
Macro-average	 prec: 0.82703507, rec: 0.85283166, f1: 0.8397352
Micro-average	 prec: 0.825483, rec: 0.8526151, f1: 0.83882976
Epoch 5/9 started, lr: 0.0019607844, dataset size: 4711
Epoch 5/9 - 150.46s - loss: 420.6738 - batches: 316
Quality on test dataset: 
time to finish evaluation: 15.79s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3599	 1087	 479	 0.76803243	 0.88254046	 0.82131445
B-Protein	 3232	 830	 357	 0.7956672	 0.9005294	 0.8448569
tp: 6831 fp: 1917 fn: 836 labels: 2
Macro-average	 prec: 0.7818498, rec: 0.8915349, f1: 0.83309764
Micro-average	 prec: 0.7808642, rec: 0.8909613, f1: 0.8322876
Epoch 6/9 started, lr: 0.0019512196, dataset size: 4711
Epoch 6/9 - 141.26s - loss: 365.05435 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.11s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3647	 1098	 431	 0.7685985	 0.89431095	 0.8267029
B-Protein	 3165	 599	 424	 0.8408608	 0.88186127	 0.8608731
tp: 6812 fp: 1697 fn: 855 labels: 2
Macro-average	 prec: 0.80472964, rec: 0.8880861, f1: 0.8443555
Micro-average	 prec: 0.8005641, rec: 0.8884831, f1: 0.8422354
Epoch 7/9 started, lr: 0.0019417477, dataset size: 4711
Epoch 7/9 - 142.54s - loss: 323.5749 - batches: 316
Quality on test dataset: 
time to finish evaluation: 19.06s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3517	 747	 561	 0.8248124	 0.86243254	 0.8432031
B-Protein	 3112	 493	 477	 0.8632455	 0.8670939	 0.8651654
tp: 6629 fp: 1240 fn: 1038 labels: 2
Macro-average	 prec: 0.84402895, rec: 0.86476326, f1: 0.8542703
Micro-average	 prec: 0.8424196, rec: 0.8646146, f1: 0.8533728
Epoch 8/9 started, lr: 0.0019323673, dataset size: 4711
Epoch 8/9 - 141.37s - loss: 268.10205 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.47s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3466	 634	 612	 0.8453659	 0.8499264	 0.84764004
B-Protein	 3070	 428	 519	 0.87764436	 0.8553915	 0.8663751
tp: 6536 fp: 1062 fn: 1131 labels: 2
Macro-average	 prec: 0.86150515, rec: 0.852659, f1: 0.85705924
Micro-average	 prec: 0.8602264, rec: 0.8524847, f1: 0.856338
Epoch 9/9 started, lr: 0.001923077, dataset size: 4711
Epoch 9/9 - 145.62s - loss: 243.25482 - batches: 316
Quality on test dataset: 
time to finish evaluation: 15.91s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3478	 734	 600	 0.825736	 0.85286903	 0.8390832
B-Protein	 3101	 472	 488	 0.8678981	 0.864029	 0.8659592
tp: 6579 fp: 1206 fn: 1088 labels: 2
Macro-average	 prec: 0.846817, rec: 0.858449, f1: 0.85259336
Micro-average	 prec: 0.8450867, rec: 0.85809314, f1: 0.85154027
CPU times: user 8.89 s, sys: 1.01 s, total: 9.9 s
Wall time: 24min 59s
In [23]:
!cd ~/annotator_logs/ && ls -lt
total 24
-rw-r--r-- 1 root root 4564 Feb 20 17:47 NerDLApproach_de76987bad55.log
-rw-r--r-- 1 root root 4554 Feb 20 17:11 NerDLApproach_5fbeff984cd0.log
-rw-r--r-- 1 root root 4567 Feb 20 16:42 NerDLApproach_1415e230cd77.log
In [24]:
!cat ~/annotator_logs/NerDLApproach_de76987bad55.log
Name of the selected graph: ner-dl/blstm_10_100_128_120.pb
Training started - total epochs: 9 - lr: 0.002 - batch size: 15 - labels: 3 - chars: 80 - training examples: 4711


Epoch 1/9 started, lr: 0.002, dataset size: 4711


Epoch 1/9 - 167.27s - loss: 2205.5518 - batches: 316
Quality on test dataset: 
time to finish evaluation: 17.23s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3217	 784	 861	 0.804049	 0.7888671	 0.7963857
B-Protein	 2736	 636	 853	 0.8113879	 0.76232934	 0.78609395
tp: 5953 fp: 1420 fn: 1714 labels: 2
Macro-average	 prec: 0.80771846, rec: 0.7755982, f1: 0.79133254
Micro-average	 prec: 0.8074054, rec: 0.7764445, f1: 0.79162234


Epoch 2/9 started, lr: 0.0019900498, dataset size: 4711


Epoch 2/9 - 169.95s - loss: 958.2137 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.87s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3290	 729	 788	 0.8186116	 0.806768	 0.8126467
B-Protein	 2935	 576	 654	 0.8359442	 0.81777656	 0.8267606
tp: 6225 fp: 1305 fn: 1442 labels: 2
Macro-average	 prec: 0.8272779, rec: 0.8122723, f1: 0.8197065
Micro-average	 prec: 0.82669324, rec: 0.81192124, f1: 0.8192407


Epoch 3/9 started, lr: 0.001980198, dataset size: 4711


Epoch 3/9 - 179.10s - loss: 686.5155 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.94s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3140	 333	 938	 0.90411747	 0.76998526	 0.83167785
B-Protein	 2928	 420	 661	 0.87455195	 0.8158261	 0.8441689
tp: 6068 fp: 753 fn: 1599 labels: 2
Macro-average	 prec: 0.8893347, rec: 0.7929057, f1: 0.83835644
Micro-average	 prec: 0.88960564, rec: 0.7914438, f1: 0.83765876


Epoch 4/9 started, lr: 0.0019704434, dataset size: 4711


Epoch 4/9 - 171.52s - loss: 531.3967 - batches: 316
Quality on test dataset: 
time to finish evaluation: 17.02s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3305	 424	 773	 0.8862966	 0.8104463	 0.8466761
B-Protein	 3049	 474	 540	 0.86545557	 0.84954023	 0.857424
tp: 6354 fp: 898 fn: 1313 labels: 2
Macro-average	 prec: 0.87587607, rec: 0.82999325, f1: 0.8523176
Micro-average	 prec: 0.87617207, rec: 0.82874656, f1: 0.8517997


Epoch 5/9 started, lr: 0.0019607844, dataset size: 4711


Epoch 5/9 - 177.17s - loss: 453.0661 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.64s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3619	 1193	 459	 0.7520781	 0.88744485	 0.81417316
B-Protein	 3266	 885	 323	 0.78679836	 0.91000277	 0.8439276
tp: 6885 fp: 2078 fn: 782 labels: 2
Macro-average	 prec: 0.76943827, rec: 0.89872384, f1: 0.8290711
Micro-average	 prec: 0.76815796, rec: 0.8980044, f1: 0.82802165


Epoch 6/9 started, lr: 0.0019512196, dataset size: 4711


Epoch 6/9 - 179.64s - loss: 385.0776 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.89s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3515	 799	 563	 0.81478906	 0.8619421	 0.83770263
B-Protein	 3161	 603	 428	 0.8397981	 0.8807467	 0.85978514
tp: 6676 fp: 1402 fn: 991 labels: 2
Macro-average	 prec: 0.8272936, rec: 0.87134445, f1: 0.84874785
Micro-average	 prec: 0.8264422, rec: 0.87074476, f1: 0.84801525


Epoch 7/9 started, lr: 0.0019417477, dataset size: 4711


Epoch 7/9 - 156.79s - loss: 316.13107 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.65s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3510	 723	 568	 0.82919914	 0.86071604	 0.8446637
B-Protein	 3186	 569	 403	 0.8484687	 0.8877125	 0.86764705
tp: 6696 fp: 1292 fn: 971 labels: 2
Macro-average	 prec: 0.8388339, rec: 0.8742143, f1: 0.85615873
Micro-average	 prec: 0.8382574, rec: 0.87335336, f1: 0.8554455


Epoch 8/9 started, lr: 0.0019323673, dataset size: 4711


Epoch 8/9 - 170.21s - loss: 276.27155 - batches: 316
Quality on test dataset: 
time to finish evaluation: 17.32s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3570	 861	 508	 0.8056872	 0.87542915	 0.8391115
B-Protein	 3199	 582	 390	 0.8460725	 0.89133465	 0.868114
tp: 6769 fp: 1443 fn: 898 labels: 2
Macro-average	 prec: 0.8258798, rec: 0.8833819, f1: 0.8536637
Micro-average	 prec: 0.8242815, rec: 0.88287467, f1: 0.85257256


Epoch 9/9 started, lr: 0.001923077, dataset size: 4711


Epoch 9/9 - 157.90s - loss: 234.95387 - batches: 316
Quality on test dataset: 
time to finish evaluation: 16.54s
label	 tp	 fp	 fn	 prec	 rec	 f1
I-Protein	 3514	 652	 564	 0.84349495	 0.8616969	 0.85249877
B-Protein	 3133	 520	 456	 0.85765123	 0.87294513	 0.8652306
tp: 6647 fp: 1172 fn: 1020 labels: 2
Macro-average	 prec: 0.85057306, rec: 0.867321, f1: 0.8588654
Micro-average	 prec: 0.8501087, rec: 0.8669623, f1: 0.8584528
In [ ]:
import pyspark.sql.functions as F

predictions = ner_model.transform(test_data)

predictions.select(F.explode(F.arrays_zip('token.result','label.result','ner.result')).alias("cols")) \
.select(F.expr("cols['0']").alias("token"),
        F.expr("cols['1']").alias("ground_truth"),
        F.expr("cols['2']").alias("prediction")).show(truncate=False)
In [26]:
from sklearn.metrics import classification_report, accuracy_score

preds_df = predictions.select(F.explode(F.arrays_zip('token.result','label.result','ner.result')).alias("cols")) \
.select(F.expr("cols['0']").alias("token"),
        F.expr("cols['1']").alias("ground_truth"),
        F.expr("cols['2']").alias("prediction")).toPandas()

print (classification_report(preds_df['ground_truth'], preds_df['prediction']))
print (accuracy_score(preds_df['ground_truth'], preds_df['prediction']))
              precision    recall  f1-score   support

   B-Protein       0.86      0.87      0.87      3589
   I-Protein       0.84      0.86      0.85      4078
           O       0.99      0.98      0.98     66957

    accuracy                           0.97     74624
   macro avg       0.90      0.91      0.90     74624
weighted avg       0.97      0.97      0.97     74624

0.9716713121783876
Saving the Trained Model
In [27]:
ner_model.stages
Out[27]:
[WORD_EMBEDDINGS_MODEL_48cffc8b9a76, NerDLModel_79a590c3689d]
In [28]:
ner_model.stages[1].write().overwrite().save("/content/drive/MyDrive/BioNLP09_IOB_NER_Model/Ner_glove_100d_e9_b10_lr0.02_90_91")
Prediction Pipeline
In [32]:
document = DocumentAssembler()\
    .setInputCol("text")\
    .setOutputCol("document")

sentence = SentenceDetector()\
    .setInputCols(['document'])\
    .setOutputCol('sentence')

token = Tokenizer()\
    .setInputCols(['sentence'])\
    .setOutputCol('token')
    
glove_embeddings = WordEmbeddingsModel.pretrained()\
    .setInputCols(["document", "token"])\
    .setOutputCol("embeddings")

loaded_ner_model = NerDLModel.load("/content/drive/MyDrive/BioNLP09_IOB_NER_Model/Ner_glove_100d_e9_b10_lr0.02_90_91")\
    .setInputCols(["sentence", "token", "embeddings"])\
    .setOutputCol("ner")

converter = NerConverter()\
    .setInputCols(["sentence", "token", "ner"])\
    .setOutputCol("ner_span")

ner_prediction_pipeline = Pipeline(stages = [
      document,
      sentence,
      token,
      glove_embeddings,
      loaded_ner_model,
      converter
  ])

empty_data = spark.createDataFrame([['']]).toDF("text")

prediction_model = ner_prediction_pipeline.fit(empty_data)
glove_100d download started this may take some time.
Approximate size to download 145.3 MB
[OK!]
In [33]:
text = '''
MACROPHAGES ARE MONONUCLEAR phagocytes that reside within almost all tissues including adipose tissue, where they are identifiable as distinct populations with tissue-specific morphology, localization, and function (1). During the process of atherosclerosis, monocytes adhere to the endothelium and migrate into the intima, express scavenger receptors, and bind internalized lipoprotein particles resulting in the formation of foam cells (2). In obesity, adipose tissue contains an increased number of resident macrophages (3, 4). Macrophage accumulation in proportion to adipocyte size may increase the adipose tissue production of proinflammatory and acute-phase molecules and thereby contribute to the pathophysiological consequences of obesity (1, 3). These facts indicate that macrophages play an important role in a variety of diseases. When activated, macrophages release stereotypical profiles of cytokines and biological molecules such as nitric oxide TNF-α, IL-6, and IL-1 (5). TNF-α is a potent chemoattractant (6) and originates predominantly from residing mouse peritoneal macrophages (MPM) and mast cells (7). TNF-α induces leukocyte adhesion and degranulation, stimulates nicotinamide adenine dinucleotide phosphate (NADPH) oxidase, and enhances expression of IL-2 receptors and expression of E-selectin and intercellular adhesion molecules on the endothelium (8). TNF-α also stimulates expression of IL-1, IL-2, IL-6, and platelet-activating factor receptor (9). In addition, TNF-α decreases insulin sensitivity and increases lipolysis in adipocytes (10, 11). IL-6 also increase lipolysis and has been implicated in the hypertriglyceridemia and increased serum free fatty acid levels associated with obesity (12). Increased IL-6 signaling induces the expression of C-reactive protein and haptoglubin in liver (13). Recombinant IL-6 treatment increases atherosclerotic lesion size 5-fold (14). IL-6 also dose-dependently increases macrophage oxidative low-density lipoprotein (LDL) degradation and CD36 mRNA expression in vitro (15). These data clearly indicate that IL-6 and TNF-α are important pathogenetic factors associated with obesity, insulin resistance, and atherosclerosis. However, the factors regulating gene expression of these cytokines in macrophages have not been fully clarified.
'''

sample_data = spark.createDataFrame([[text]]).toDF("text")

sample_data.show(truncate=100)
+----------------------------------------------------------------------------------------------------+
|                                                                                                text|
+----------------------------------------------------------------------------------------------------+
|
MACROPHAGES ARE MONONUCLEAR phagocytes that reside within almost all tissues including adipose t...|
+----------------------------------------------------------------------------------------------------+

In [34]:
preds = prediction_model.transform(sample_data)

result_df = preds.select(F.explode(F.arrays_zip("ner_span.result","ner_span.metadata")).alias("entities")) \
                .select(F.expr("entities['0']").alias("chunk"),
                        F.expr("entities['1'].entity").alias("entity")).show(truncate=False)
+--------------+-------+
|chunk         |entity |
+--------------+-------+
|IL-6          |Protein|
|IL-1 (5).     |Protein|
|TNF-α         |Protein|
|IL-2 receptors|Protein|
|IL-2          |Protein|
|IL-6          |Protein|
|insulin       |Protein|
|haptoglubin   |Protein|
|CD36          |Protein|
|IL-6          |Protein|
|insulin       |Protein|
+--------------+-------+

In [35]:
from sparknlp.base import LightPipeline

light_model = LightPipeline(prediction_model)

result = light_model.annotate(text)

list(zip(result['token'], result['ner']))
Out[35]:
[('MACROPHAGES', 'O'),
 ('ARE', 'O'),
 ('MONONUCLEAR', 'O'),
 ('phagocytes', 'O'),
 ('that', 'O'),
 ('reside', 'O'),
 ('within', 'O'),
 ('almost', 'O'),
 ('all', 'O'),
 ('tissues', 'O'),
 ('including', 'O'),
 ('adipose', 'O'),
 ('tissue', 'O'),
 (',', 'O'),
 ('where', 'O'),
 ('they', 'O'),
 ('are', 'O'),
 ('identifiable', 'O'),
 ('as', 'O'),
 ('distinct', 'O'),
 ('populations', 'O'),
 ('with', 'O'),
 ('tissue-specific', 'O'),
 ('morphology', 'O'),
 (',', 'O'),
 ('localization', 'O'),
 (',', 'O'),
 ('and', 'O'),
 ('function', 'O'),
 ('(', 'O'),
 ('1', 'O'),
 (').', 'O'),
 ('During', 'O'),
 ('the', 'O'),
 ('process', 'O'),
 ('of', 'O'),
 ('atherosclerosis', 'O'),
 (',', 'O'),
 ('monocytes', 'O'),
 ('adhere', 'O'),
 ('to', 'O'),
 ('the', 'O'),
 ('endothelium', 'O'),
 ('and', 'O'),
 ('migrate', 'O'),
 ('into', 'O'),
 ('the', 'O'),
 ('intima', 'O'),
 (',', 'O'),
 ('express', 'O'),
 ('scavenger', 'O'),
 ('receptors', 'O'),
 (',', 'O'),
 ('and', 'O'),
 ('bind', 'O'),
 ('internalized', 'O'),
 ('lipoprotein', 'O'),
 ('particles', 'O'),
 ('resulting', 'O'),
 ('in', 'O'),
 ('the', 'O'),
 ('formation', 'O'),
 ('of', 'O'),
 ('foam', 'O'),
 ('cells', 'O'),
 ('(', 'O'),
 ('2', 'O'),
 (').', 'O'),
 ('In', 'O'),
 ('obesity', 'O'),
 (',', 'O'),
 ('adipose', 'O'),
 ('tissue', 'O'),
 ('contains', 'O'),
 ('an', 'O'),
 ('increased', 'O'),
 ('number', 'O'),
 ('of', 'O'),
 ('resident', 'O'),
 ('macrophages', 'O'),
 ('(', 'O'),
 ('3', 'O'),
 (',', 'O'),
 ('4', 'O'),
 (').', 'O'),
 ('Macrophage', 'O'),
 ('accumulation', 'O'),
 ('in', 'O'),
 ('proportion', 'O'),
 ('to', 'O'),
 ('adipocyte', 'O'),
 ('size', 'O'),
 ('may', 'O'),
 ('increase', 'O'),
 ('the', 'O'),
 ('adipose', 'O'),
 ('tissue', 'O'),
 ('production', 'O'),
 ('of', 'O'),
 ('proinflammatory', 'O'),
 ('and', 'O'),
 ('acute-phase', 'O'),
 ('molecules', 'O'),
 ('and', 'O'),
 ('thereby', 'O'),
 ('contribute', 'O'),
 ('to', 'O'),
 ('the', 'O'),
 ('pathophysiological', 'O'),
 ('consequences', 'O'),
 ('of', 'O'),
 ('obesity', 'O'),
 ('(', 'O'),
 ('1', 'O'),
 (',', 'O'),
 ('3', 'O'),
 (').', 'O'),
 ('These', 'O'),
 ('facts', 'O'),
 ('indicate', 'O'),
 ('that', 'O'),
 ('macrophages', 'O'),
 ('play', 'O'),
 ('an', 'O'),
 ('important', 'O'),
 ('role', 'O'),
 ('in', 'O'),
 ('a', 'O'),
 ('variety', 'O'),
 ('of', 'O'),
 ('diseases', 'O'),
 ('.', 'O'),
 ('When', 'O'),
 ('activated', 'O'),
 (',', 'O'),
 ('macrophages', 'O'),
 ('release', 'O'),
 ('stereotypical', 'O'),
 ('profiles', 'O'),
 ('of', 'O'),
 ('cytokines', 'O'),
 ('and', 'O'),
 ('biological', 'O'),
 ('molecules', 'O'),
 ('such', 'O'),
 ('as', 'O'),
 ('nitric', 'O'),
 ('oxide', 'O'),
 ('TNF-α', 'O'),
 (',', 'O'),
 ('IL-6', 'B-Protein'),
 (',', 'O'),
 ('and', 'O'),
 ('IL-1', 'B-Protein'),
 ('(', 'I-Protein'),
 ('5', 'I-Protein'),
 (').', 'I-Protein'),
 ('TNF-α', 'I-Protein'),
 ('is', 'O'),
 ('a', 'O'),
 ('potent', 'O'),
 ('chemoattractant', 'O'),
 ('(', 'O'),
 ('6', 'O'),
 (')', 'O'),
 ('and', 'O'),
 ('originates', 'O'),
 ('predominantly', 'O'),
 ('from', 'O'),
 ('residing', 'O'),
 ('mouse', 'O'),
 ('peritoneal', 'O'),
 ('macrophages', 'O'),
 ('(', 'O'),
 ('MPM', 'O'),
 (')', 'O'),
 ('and', 'O'),
 ('mast', 'O'),
 ('cells', 'O'),
 ('(', 'O'),
 ('7', 'O'),
 (').', 'O'),
 ('TNF-α', 'O'),
 ('induces', 'O'),
 ('leukocyte', 'O'),
 ('adhesion', 'O'),
 ('and', 'O'),
 ('degranulation', 'O'),
 (',', 'O'),
 ('stimulates', 'O'),
 ('nicotinamide', 'O'),
 ('adenine', 'O'),
 ('dinucleotide', 'O'),
 ('phosphate', 'O'),
 ('(', 'O'),
 ('NADPH', 'O'),
 (')', 'O'),
 ('oxidase', 'O'),
 (',', 'O'),
 ('and', 'O'),
 ('enhances', 'O'),
 ('expression', 'O'),
 ('of', 'O'),
 ('IL-2', 'B-Protein'),
 ('receptors', 'I-Protein'),
 ('and', 'O'),
 ('expression', 'O'),
 ('of', 'O'),
 ('E-selectin', 'O'),
 ('and', 'O'),
 ('intercellular', 'O'),
 ('adhesion', 'O'),
 ('molecules', 'O'),
 ('on', 'O'),
 ('the', 'O'),
 ('endothelium', 'O'),
 ('(', 'O'),
 ('8', 'O'),
 (').', 'O'),
 ('TNF-α', 'O'),
 ('also', 'O'),
 ('stimulates', 'O'),
 ('expression', 'O'),
 ('of', 'O'),
 ('IL-1', 'O'),
 (',', 'O'),
 ('IL-2', 'B-Protein'),
 (',', 'O'),
 ('IL-6', 'B-Protein'),
 (',', 'O'),
 ('and', 'O'),
 ('platelet-activating', 'O'),
 ('factor', 'O'),
 ('receptor', 'O'),
 ('(', 'O'),
 ('9', 'O'),
 (').', 'O'),
 ('In', 'O'),
 ('addition', 'O'),
 (',', 'O'),
 ('TNF-α', 'O'),
 ('decreases', 'O'),
 ('insulin', 'B-Protein'),
 ('sensitivity', 'O'),
 ('and', 'O'),
 ('increases', 'O'),
 ('lipolysis', 'O'),
 ('in', 'O'),
 ('adipocytes', 'O'),
 ('(', 'O'),
 ('10', 'O'),
 (',', 'O'),
 ('11', 'O'),
 (').', 'O'),
 ('IL-6', 'O'),
 ('also', 'O'),
 ('increase', 'O'),
 ('lipolysis', 'O'),
 ('and', 'O'),
 ('has', 'O'),
 ('been', 'O'),
 ('implicated', 'O'),
 ('in', 'O'),
 ('the', 'O'),
 ('hypertriglyceridemia', 'O'),
 ('and', 'O'),
 ('increased', 'O'),
 ('serum', 'O'),
 ('free', 'O'),
 ('fatty', 'O'),
 ('acid', 'O'),
 ('levels', 'O'),
 ('associated', 'O'),
 ('with', 'O'),
 ('obesity', 'O'),
 ('(', 'O'),
 ('12', 'O'),
 (').', 'O'),
 ('Increased', 'O'),
 ('IL-6', 'O'),
 ('signaling', 'O'),
 ('induces', 'O'),
 ('the', 'O'),
 ('expression', 'O'),
 ('of', 'O'),
 ('C-reactive', 'O'),
 ('protein', 'O'),
 ('and', 'O'),
 ('haptoglubin', 'B-Protein'),
 ('in', 'O'),
 ('liver', 'O'),
 ('(', 'O'),
 ('13', 'O'),
 (').', 'O'),
 ('Recombinant', 'O'),
 ('IL-6', 'O'),
 ('treatment', 'O'),
 ('increases', 'O'),
 ('atherosclerotic', 'O'),
 ('lesion', 'O'),
 ('size', 'O'),
 ('5-fold', 'O'),
 ('(', 'O'),
 ('14', 'O'),
 (').', 'O'),
 ('IL-6', 'O'),
 ('also', 'O'),
 ('dose-dependently', 'O'),
 ('increases', 'O'),
 ('macrophage', 'O'),
 ('oxidative', 'O'),
 ('low-density', 'O'),
 ('lipoprotein', 'O'),
 ('(', 'O'),
 ('LDL', 'O'),
 (')', 'O'),
 ('degradation', 'O'),
 ('and', 'O'),
 ('CD36', 'B-Protein'),
 ('mRNA', 'O'),
 ('expression', 'O'),
 ('in', 'O'),
 ('vitro', 'O'),
 ('(', 'O'),
 ('15', 'O'),
 (').', 'O'),
 ('These', 'O'),
 ('data', 'O'),
 ('clearly', 'O'),
 ('indicate', 'O'),
 ('that', 'O'),
 ('IL-6', 'B-Protein'),
 ('and', 'O'),
 ('TNF-α', 'O'),
 ('are', 'O'),
 ('important', 'O'),
 ('pathogenetic', 'O'),
 ('factors', 'O'),
 ('associated', 'O'),
 ('with', 'O'),
 ('obesity', 'O'),
 (',', 'O'),
 ('insulin', 'B-Protein'),
 ('resistance', 'O'),
 (',', 'O'),
 ('and', 'O'),
 ('atherosclerosis', 'O'),
 ('.', 'O'),
 ('However', 'O'),
 (',', 'O'),
 ('the', 'O'),
 ('factors', 'O'),
 ('regulating', 'O'),
 ('gene', 'O'),
 ('expression', 'O'),
 ('of', 'O'),
 ('these', 'O'),
 ('cytokines', 'O'),
 ('in', 'O'),
 ('macrophages', 'O'),
 ('have', 'O'),
 ('not', 'O'),
 ('been', 'O'),
 ('fully', 'O'),
 ('clarified', 'O'),
 ('.', 'O')]
In [36]:
import pandas as pd

result = light_model.fullAnnotate(text)

ner_df= pd.DataFrame([(int(x.metadata['sentence']), x.result, x.begin, x.end, y.result) for x,y in zip(result[0]["token"], result[0]["ner"])], 
                      columns=['sent_id','token','start','end','ner'])
ner_df.head(15)
Out[36]:
sent_id	token	start	end	ner
0	0	MACROPHAGES	1	11	O
1	0	ARE	13	15	O
2	0	MONONUCLEAR	17	27	O
3	0	phagocytes	29	38	O
4	0	that	40	43	O
5	0	reside	45	50	O
6	0	within	52	57	O
7	0	almost	59	64	O
8	0	all	66	68	O
9	0	tissues	70	76	O
10	0	including	78	86	O
11	0	adipose	88	94	O
12	0	tissue	96	101	O
13	0	,	102	102	O
14	0	where	104	108	O
Highlight Entities
In [37]:
ann_text = light_model.fullAnnotate(text)[0]
ann_text.keys()
Out[37]:
dict_keys(['document', 'ner_span', 'token', 'ner', 'embeddings', 'sentence'])
In [38]:
from sparknlp_display import NerVisualizer

visualiser = NerVisualizer()
print ('Standard Output')
visualiser.display(ann_text, label_col='ner_span', document_col='document')
Standard Output

MACROPHAGES ARE MONONUCLEAR phagocytes that reside within almost all tissues including adipose tissue, where they are identifiable as distinct populations with tissue-specific morphology, localization, and function (1). During the process of atherosclerosis, monocytes adhere to the endothelium and migrate into the intima, express scavenger receptors, and bind internalized lipoprotein particles resulting in the formation of foam cells (2). In obesity, adipose tissue contains an increased number of resident macrophages (3, 4). Macrophage accumulation in proportion to adipocyte size may increase the adipose tissue production of proinflammatory and acute-phase molecules and thereby contribute to the pathophysiological consequences of obesity (1, 3). These facts indicate that macrophages play an important role in a variety of diseases. When activated, macrophages release stereotypical profiles of cytokines and biological molecules such as nitric oxide TNF-α, IL-6 Protein, and IL-1 (5). Protein TNF-α Protein is a potent chemoattractant (6) and originates predominantly from residing mouse peritoneal macrophages (MPM) and mast cells (7). TNF-α induces leukocyte adhesion and degranulation, stimulates nicotinamide adenine dinucleotide phosphate (NADPH) oxidase, and enhances expression of IL-2 receptors Protein and expression of E-selectin and intercellular adhesion molecules on the endothelium (8). TNF-α also stimulates expression of IL-1, IL-2 Protein, IL-6 Protein, and platelet-activating factor receptor (9). In addition, TNF-α decreases insulin Protein sensitivity and increases lipolysis in adipocytes (10, 11). IL-6 also increase lipolysis and has been implicated in the hypertriglyceridemia and increased serum free fatty acid levels associated with obesity (12). Increased IL-6 signaling induces the expression of C-reactive protein and haptoglubin Protein in liver (13). Recombinant IL-6 treatment increases atherosclerotic lesion size 5-fold (14). IL-6 also dose-dependently increases macrophage oxidative low-density lipoprotein (LDL) degradation and CD36 Protein mRNA expression in vitro (15). These data clearly indicate that IL-6 Protein and TNF-α are important pathogenetic factors associated with obesity, insulin Protein resistance, and atherosclerosis. However, the factors regulating gene expression of these cytokines in macrophages have not been fully clarified.
STREAMLIT
In [1]:
! pip install -q pyspark==3.1.2 spark-nlp

! pip install -q spark-nlp-display
In [2]:
!pip install streamlit

!pip install pyngrok==4.1.1
Requirement already satisfied: streamlit in /usr/local/lib/python3.7/dist-packages (1.5.1)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from streamlit) (1.21.5)
Requirement already satisfied: toml in /usr/local/lib/python3.7/dist-packages (from streamlit) (0.10.2)
Requirement already satisfied: pympler>=0.9 in /usr/local/lib/python3.7/dist-packages (from streamlit) (1.0.1)
Requirement already satisfied: base58 in /usr/local/lib/python3.7/dist-packages (from streamlit) (2.1.1)
Requirement already satisfied: pandas>=0.21.0 in /usr/local/lib/python3.7/dist-packages (from streamlit) (1.3.5)
Requirement already satisfied: tornado>=5.0 in /usr/local/lib/python3.7/dist-packages (from streamlit) (5.1.1)
Requirement already satisfied: cachetools>=4.0 in /usr/local/lib/python3.7/dist-packages (from streamlit) (4.2.4)
Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.7/dist-packages (from streamlit) (7.1.2)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from streamlit) (3.10.0.2)
Requirement already satisfied: gitpython!=3.1.19 in /usr/local/lib/python3.7/dist-packages (from streamlit) (3.1.27)
Requirement already satisfied: python-dateutil in /usr/local/lib/python3.7/dist-packages (from streamlit) (2.8.2)
Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from streamlit) (2.23.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from streamlit) (21.3)
Requirement already satisfied: pyarrow in /usr/local/lib/python3.7/dist-packages (from streamlit) (6.0.1)
Requirement already satisfied: watchdog in /usr/local/lib/python3.7/dist-packages (from streamlit) (2.1.6)
Requirement already satisfied: blinker in /usr/local/lib/python3.7/dist-packages (from streamlit) (1.4)
Requirement already satisfied: pydeck>=0.1.dev5 in /usr/local/lib/python3.7/dist-packages (from streamlit) (0.7.1)
Requirement already satisfied: click>=7.0 in /usr/local/lib/python3.7/dist-packages (from streamlit) (7.1.2)
Requirement already satisfied: altair>=3.2.0 in /usr/local/lib/python3.7/dist-packages (from streamlit) (4.2.0)
Requirement already satisfied: tzlocal in /usr/local/lib/python3.7/dist-packages (from streamlit) (1.5.1)
Requirement already satisfied: astor in /usr/local/lib/python3.7/dist-packages (from streamlit) (0.8.1)
Requirement already satisfied: attrs in /usr/local/lib/python3.7/dist-packages (from streamlit) (21.4.0)
Requirement already satisfied: validators in /usr/local/lib/python3.7/dist-packages (from streamlit) (0.18.2)
Requirement already satisfied: protobuf!=3.11,>=3.6.0 in /usr/local/lib/python3.7/dist-packages (from streamlit) (3.17.3)
Requirement already satisfied: jsonschema>=3.0 in /usr/local/lib/python3.7/dist-packages (from altair>=3.2.0->streamlit) (4.3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.7/dist-packages (from altair>=3.2.0->streamlit) (2.11.3)
Requirement already satisfied: entrypoints in /usr/local/lib/python3.7/dist-packages (from altair>=3.2.0->streamlit) (0.4)
Requirement already satisfied: toolz in /usr/local/lib/python3.7/dist-packages (from altair>=3.2.0->streamlit) (0.11.2)
Requirement already satisfied: gitdb<5,>=4.0.1 in /usr/local/lib/python3.7/dist-packages (from gitpython!=3.1.19->streamlit) (4.0.9)
Requirement already satisfied: smmap<6,>=3.0.1 in /usr/local/lib/python3.7/dist-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.19->streamlit) (5.0.0)
Requirement already satisfied: pyrsistent!=0.17.0,!=0.17.1,!=0.17.2,>=0.14.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema>=3.0->altair>=3.2.0->streamlit) (0.18.1)
Requirement already satisfied: importlib-resources>=1.4.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema>=3.0->altair>=3.2.0->streamlit) (5.4.0)
Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from jsonschema>=3.0->altair>=3.2.0->streamlit) (4.11.0)
Requirement already satisfied: zipp>=3.1.0 in /usr/local/lib/python3.7/dist-packages (from importlib-resources>=1.4.0->jsonschema>=3.0->altair>=3.2.0->streamlit) (3.7.0)
Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.21.0->streamlit) (2018.9)
Requirement already satisfied: six>=1.9 in /usr/local/lib/python3.7/dist-packages (from protobuf!=3.11,>=3.6.0->streamlit) (1.15.0)
Requirement already satisfied: ipywidgets>=7.0.0 in /usr/local/lib/python3.7/dist-packages (from pydeck>=0.1.dev5->streamlit) (7.6.5)
Requirement already satisfied: traitlets>=4.3.2 in /usr/local/lib/python3.7/dist-packages (from pydeck>=0.1.dev5->streamlit) (5.1.1)
Requirement already satisfied: ipykernel>=5.1.2 in /usr/local/lib/python3.7/dist-packages (from pydeck>=0.1.dev5->streamlit) (6.9.1)
Requirement already satisfied: debugpy<2.0,>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (1.0.0)
Requirement already satisfied: matplotlib-inline<0.2.0,>=0.1.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (0.1.3)
Requirement already satisfied: jupyter-client<8.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (5.3.5)
Requirement already satisfied: nest-asyncio in /usr/local/lib/python3.7/dist-packages (from ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (1.5.4)
Requirement already satisfied: ipython>=7.23.1 in /usr/local/lib/python3.7/dist-packages (from ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (7.31.1)
Requirement already satisfied: decorator in /usr/local/lib/python3.7/dist-packages (from ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (4.4.2)
Requirement already satisfied: pickleshare in /usr/local/lib/python3.7/dist-packages (from ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (0.7.5)
Requirement already satisfied: jedi>=0.16 in /usr/local/lib/python3.7/dist-packages (from ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (0.18.1)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (3.0.28)
Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.7/dist-packages (from ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (4.8.0)
Requirement already satisfied: setuptools>=18.5 in /usr/local/lib/python3.7/dist-packages (from ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (57.4.0)
Requirement already satisfied: backcall in /usr/local/lib/python3.7/dist-packages (from ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (0.2.0)
Requirement already satisfied: pygments in /usr/local/lib/python3.7/dist-packages (from ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (2.6.1)
Requirement already satisfied: nbformat>=4.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (5.1.3)
Requirement already satisfied: widgetsnbextension~=3.5.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (3.5.2)
Requirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (0.2.0)
Requirement already satisfied: jupyterlab-widgets>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (1.0.2)
Requirement already satisfied: parso<0.9.0,>=0.8.0 in /usr/local/lib/python3.7/dist-packages (from jedi>=0.16->ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (0.8.3)
Requirement already satisfied: MarkupSafe>=0.23 in /usr/local/lib/python3.7/dist-packages (from jinja2->altair>=3.2.0->streamlit) (2.0.1)
Requirement already satisfied: jupyter-core>=4.6.0 in /usr/local/lib/python3.7/dist-packages (from jupyter-client<8.0->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (4.9.1)
Requirement already satisfied: pyzmq>=13 in /usr/local/lib/python3.7/dist-packages (from jupyter-client<8.0->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (22.3.0)
Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.7/dist-packages (from pexpect>4.3->ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (0.7.0)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->ipython>=7.23.1->ipykernel>=5.1.2->pydeck>=0.1.dev5->streamlit) (0.2.5)
Requirement already satisfied: notebook>=4.4.1 in /usr/local/lib/python3.7/dist-packages (from widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (5.3.1)
Requirement already satisfied: nbconvert in /usr/local/lib/python3.7/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (5.6.1)
Requirement already satisfied: terminado>=0.8.1 in /usr/local/lib/python3.7/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (0.13.1)
Requirement already satisfied: Send2Trash in /usr/local/lib/python3.7/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (1.8.0)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (0.7.1)
Requirement already satisfied: testpath in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (0.5.0)
Requirement already satisfied: bleach in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (4.1.0)
Requirement already satisfied: pandocfilters>=1.4.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (1.5.0)
Requirement already satisfied: mistune<2,>=0.8.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (0.8.4)
Requirement already satisfied: webencodings in /usr/local/lib/python3.7/dist-packages (from bleach->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.0.0->pydeck>=0.1.dev5->streamlit) (0.5.1)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->streamlit) (3.0.7)
Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->streamlit) (2.10)
Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->streamlit) (3.0.4)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->streamlit) (1.24.3)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->streamlit) (2021.10.8)
Requirement already satisfied: pyngrok==4.1.1 in /usr/local/lib/python3.7/dist-packages (4.1.1)
Requirement already satisfied: PyYAML in /usr/local/lib/python3.7/dist-packages (from pyngrok==4.1.1) (3.13)
Requirement already satisfied: future in /usr/local/lib/python3.7/dist-packages (from pyngrok==4.1.1) (0.16.0)
In [3]:
! wget https://raw.githubusercontent.com/gokhanturer/NER_Model_SparkNLP/main/BioNLP09_IOB_NER_MODEL_90_91.py
--2022-02-20 19:03:30--  https://raw.githubusercontent.com/gokhanturer/NER_Model_SparkNLP/main/BioNLP09_IOB_NER_MODEL_90_91.py
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.109.133, 185.199.110.133, 185.199.111.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.109.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 9089 (8.9K) [text/plain]
Saving to: ‘BioNLP09_IOB_NER_MODEL_90_91.py’

BioNLP09_IOB_NER_MO 100%[===================>]   8.88K  --.-KB/s    in 0s      

2022-02-20 19:03:30 (65.8 MB/s) - ‘BioNLP09_IOB_NER_MODEL_90_91.py’ saved [9089/9089]

In [4]:
!ngrok authtoken 24jtZ2Watn1mc1bSG6v19fel7p1_2bYeRjRkniKqqhfgRs6ub
Authtoken saved to configuration file: /root/.ngrok2/ngrok.yml
In [5]:
!streamlit run BioNLP09_IOB_NER_MODEL_90_91.py &>/dev/null&
In [6]:
from pyngrok import ngrok

public_url = ngrok.connect(port='8501')
public_url
Out[6]:
'http://21a0-35-233-139-73.ngrok.io'
In [ ]:
!killall ngrok
Zipping Model
In [7]:
import shutil

shutil.make_archive("/content/drive/MyDrive/BioNLP09_IOB_NER_Model/Ner_glove_100d_e9_b10_lr0.02_90_91", 'zip', "/content/drive/MyDrive/BioNLP09_IOB_NER_Model/Ner_glove_100d_e9_b10_lr0.02_90_91")
Out[7]:
'/content/drive/MyDrive/BioNLP09_IOB_NER_Model/Ner_glove_100d_e9_b10_lr0.02_90_91.zip'

```

</div>

## Results

```bash
+--------------+-------+
|chunk         |entity |
+--------------+-------+
|IL-6          |Protein|
|IL-1 (5).     |Protein|
|TNF-α         |Protein|
|IL-2 receptors|Protein|
|IL-2          |Protein|
|IL-6          |Protein|
|insulin       |Protein|
|haptoglubin   |Protein|
|CD36          |Protein|
|IL-6          |Protein|
|insulin       |Protein|
+--------------+-------+
```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|Ner_glove_100d|
|Type:|ner|
|Compatibility:|Spark NLP 3.1.2+|
|License:|Open Source|
|Edition:|Community|
|Input Labels:|[sentence, token, embeddings]|
|Output Labels:|[ner]|
|Language:|en|
|Size:|14.3 MB|
|Dependencies:|glove100d|

## References

This model trained based on data https://github.com/gokhanturer/NER_Model_SparkNLP/blob/main/BC5CDR-disease-IOB_train.conll

## Benchmarking

```bash
              precision    recall  f1-score   support

   B-Protein       0.86      0.87      0.87      3589
   I-Protein       0.84      0.86      0.85      4078
           O       0.99      0.98      0.98     66957

    accuracy                           0.97     74624
   macro avg       0.90      0.91      0.90     74624
weighted avg       0.97      0.97      0.97     74624

0.9716713121783876
```